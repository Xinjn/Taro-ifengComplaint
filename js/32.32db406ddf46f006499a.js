(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{"185":function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(8),i=a(9),o=a(17),c=a(18),s=a(22),r=a(140),l=a(186),d=a.n(l),u=a(139),p=function(e){Object(o.a)(Progress,e);var t=Object(c.a)(Progress);function Progress(){return Object(n.a)(this,Progress),t.apply(this,arguments)}return Object(i.a)(Progress,[{"key":"render","value":function render(){var e=this.props.step;return Object(u.jsxs)(r.o,{"className":d.a.progress,"children":[Object(u.jsx)(r.o,{"className":"".concat(d.a.progressOne," ").concat(1===e||2===e?d.a.active:""),"children":"投诉企业"}),Object(u.jsx)(r.o,{"className":"".concat(d.a.progressTwo," ").concat(2===e?d.a.active:""),"children":"投诉详情"}),Object(u.jsxs)(r.o,{"className":"".concat(d.a.progressThree),"children":[Object(u.jsx)(r.o,{"className":"".concat(d.a.icon)}),"完成投诉"]}),Object(u.jsx)(r.o,{"className":"".concat(d.a.progressLine)})]})}}]),Progress}(s.Component)},"186":function(e,t,a){e.exports={"progress":"index-module__progress___2qQNV","progressLine":"index-module__progressLine___2tmBL","progressOne":"index-module__progressOne___2_I-e","progressTwo":"index-module__progressTwo___uGXc4","progressThree":"index-module__progressThree___1eMGt","icon":"index-module__icon___1RGS7","active":"index-module__active___2dyuO"}},"244":function(e,t,a){e.exports={"details":"index-module__details___2xGkW","detailsBox":"index-module__detailsBox___Ry059","moduleTh":"index-module__moduleTh___2aSm-","moduleText":"index-module__moduleText___2OxtY","moduleInfo":"index-module__moduleInfo___3q8hH","titleBd":"index-module__titleBd___J5bBP","titleInputText":"index-module__titleInputText___28_Bu","titleClose":"index-module__titleClose___2RSEQ","errorTip":"index-module__errorTip___8DtuZ","redWord":"index-module__redWord___Y9cSX","privacy":"index-module__privacy___xKJMu","privacyText":"index-module__privacyText___3UJnx","privacySwitch":"index-module__privacySwitch___kVTNP","attachmentButtonText":"index-module__attachmentButtonText___3AjTz","contact":"index-module__contact___mt5hP","privacyTex":"index-module__privacyTex___-fU4K","privacyTel":"index-module__privacyTel___V-QSY","privacyInfo":"index-module__privacyInfo___33kaw","operation":"index-module__operation___3k5Tt","prevButton":"index-module__prevButton___u22zr","submitButton":"index-module__submitButton___1VetW","privacyCheckbox":"index-module__privacyCheckbox___6ivDJ","privacyTip":"index-module__privacyTip___3aDrA","privacyTelNumber":"index-module__privacyTelNumber___W1BZJ"}},"278":function(e,t,a){"use strict";a.r(t);var n=a(2),i=a.n(n),o=a(10),c=a(8),s=a(9),r=a(20),l=a(17),d=a(18),u=a(11),p=a(22),m=a(140),h=a(185),j=a(204),_=a(165),b=a(244),O=a.n(b),x=a(3),f=a(164),v=a(157),g=a(26),w=a(24),S=a(159),y=a(139),T=function(e){Object(l.a)(Details,e);var t,a=Object(d.a)(Details);function Details(){var e;Object(c.a)(this,Details);for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return e=a.call.apply(a,[this].concat(n)),Object(u.a)(Object(r.a)(e),"$instance",x.default.getCurrentInstance()),Object(u.a)(Object(r.a)(e),"state",{"title":"","detail":"","isShowUserInfo":!1,"isShowPicInfo":!1,"isAllowTelVisit":!1,"uploadImgUrls":[],"uploadVideoUrls":[],"serverImgPath":[],"serverVideoPath":[],"secretImgPath":[],"secretVideoPath":[],"phoneNumber":"","errorWaring":{"title":"","detail":"","picNum":"","videoNum":""},"isOpenFileUpload":!0,"isShowTitleClose":!1,"domainId":""}),Object(u.a)(Object(r.a)(e),"errorTipSwitch",!1),Object(u.a)(Object(r.a)(e),"iphoneSpecialHandle",(function(){var e=navigator.userAgent.toLowerCase();(e.indexOf("iphone")>0||e.indexOf("ipad")>0)&&document.addEventListener("focusout",(function(){document.body.scrollTop=0,document.documentElement.scrollTop=0}))})),Object(u.a)(Object(r.a)(e),"getUserPhoneNumberHandle",Object(o.a)(i.a.mark((function _callee(){var t;return i.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,Object(f.e)();case 2:(t=a.sent)&&t.data&&t.data.phoneNumberBinding&&e.setState({"phoneNumber":t.data.phoneNumberBinding});case 4:case"end":return a.stop()}}),_callee)})))),Object(u.a)(Object(r.a)(e),"storageDataInit",(function(t){var a=Object(x.getStorageSync)(t);a&&e.setState({"title":a.title||"","detail":a.detail||"","isShowUserInfo":a.isShowUserInfo||!1,"isAllowTelVisit":a.isAllowTelVisit||!1,"isShowPicInfo":a.isShowPicInfo||!1,"uploadImgUrls":a.uploadImgUrls||[],"uploadVideoUrls":a.uploadVideoUrls||[]})})),Object(u.a)(Object(r.a)(e),"updateDateInit",function(){var t=Object(o.a)(i.a.mark((function _callee2(t){var a,n,o;return i.a.wrap((function _callee2$(i){for(;;)switch(i.prev=i.next){case 0:if(a={},!t){i.next=20;break}return i.prev=2,i.next=5,Object(v.r)(t,!0);case 5:a=i.sent,i.next=11;break;case 8:i.prev=8,i.t0=i.catch(2),console.log("请求投诉接口异常");case 11:if(!a||!a.title){i.next=20;break}return i.next=14,e.decodeFileUrl(a.uploadImgUrls);case 14:return n=i.sent,i.next=17,e.decodeFileUrl(a.uploadVideoUrls,!0);case 17:return o=i.sent,i.next=20,e.setState({"title":a.title||"","detail":a.content||"","isShowUserInfo":a.isAnonymous||!1,"isShowPicInfo":!a.isOpenResource||!1,"isAllowTelVisit":a.isSyncPhone||!1,"serverImgPath":a.uploadImgUrls||[],"serverVideoPath":a.serverVideoPath||[],"secretImgPath":n||[],"secretVideoPath":o||[]});case 20:case"end":return i.stop()}}),_callee2,null,[[2,8]])})));return function(e){return t.apply(this,arguments)}}()),Object(u.a)(Object(r.a)(e),"decodeFileUrl",function(){var e=Object(o.a)(i.a.mark((function _callee3(e,t){var a;return i.a.wrap((function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:if(a=[],!(e&&e.length>0)){n.next=6;break}return n.next=4,Promise.allSettled(e.map((function(e,a){return Object(v.s)(e,t)})));case 4:a=(a=n.sent).map((function(e){return e.value}));case 6:return n.abrupt("return",a);case 7:case"end":return n.stop()}}),_callee3)})));return function(t,a){return e.apply(this,arguments)}}()),Object(u.a)(Object(r.a)(e),"savePageData",(function(){var t=e.state.domainId,a=e.state,n=a.title,i=a.detail,o=a.isShowUserInfo,c=a.isAllowTelVisit,s=a.isShowPicInfo,r=t?"updateComplainDetailData":"complainDetailData";Object(x.setStorageSync)(r,{"title":n,"detail":i,"isShowUserInfo":o,"isAllowTelVisit":c,"isShowPicInfo":s})})),Object(u.a)(Object(r.a)(e),"toBackPage",(function(){Object(S.a)({"datatype":"news_fts","behavior":"action","type":"fts_last","url":window.location.href});var t=e.state.domainId;e.savePageData(),t?e.jumpPage("pages/complain/company/index?domainId=".concat(t)):e.jumpPage("pages/complain/company/index")})),Object(u.a)(Object(r.a)(e),"jumpPage",(function(e){Object(g.l)(e)})),Object(u.a)(Object(r.a)(e),"inputChangeHandle",(function(t,a){"isAllowTelVisit"===a&&Object(S.a)({"datatype":"news_fts","behavior":"action","type":"fts_dhlxcf","url":window.location.href}),"isShowUserInfo"===a&&Object(S.a)({"datatype":"news_fts","behavior":"action","type":"fts_nm","url":window.location.href}),"isShowPicInfo"===a&&Object(S.a)({"datatype":"news_fts","behavior":"action","type":"fts_ycfj","url":window.location.href});var n={};"title"===a&&t.detail.value&&e.setState({"isShowTitleClose":!0}),"title"!==a||t.detail.value||e.setState({"isShowTitleClose":!1}),n[a]=t.detail.value,e.setState(n)})),Object(u.a)(Object(r.a)(e),"clearStateHandle",(function(t){var a={};e.setState({"isShowTitleClose":!1}),a[t]="",e.setState(a)})),Object(u.a)(Object(r.a)(e),"formCheckHandle",(function(){var t=e.state,a=t.title,n=t.detail,i=t.uploadImgUrls,o=t.uploadVideoUrls,c=t.serverImgPath,s=t.serverVideoPath,r={"title":"","detail":"","picNum":"","videoNum":""},l=[{"name":"title","data":a,"errorTip":"字数限制为4-40字"},{"name":"detail","data":n,"errorTip":"请输入投诉详情"}],d=c.concat(i),u=s.concat(o);e.errorTipSwitch=!1,l.forEach((function(t){t.data||(r[t.name]=t.errorTip,e.errorTipSwitch=!0),t.data&&"detail"===t.name&&t.data.length<20&&(r.detail="字数不得少于20字",e.errorTipSwitch=!0),t.data&&"title"===t.name&&(t.data.length<4||t.data.length>40)&&(r.title="字数限制为4-40字",e.errorTipSwitch=!0)})),d&&d.length>10&&(r.picNum="图片不能超过10张",e.errorTipSwitch=!0),u&&u.length>3&&(r.videoNum="视频不能超过3个",e.errorTipSwitch=!0),e.setState({"errorWaring":r})})),Object(u.a)(Object(r.a)(e),"submitDataHandle",Object(o.a)(i.a.mark((function _callee4(){var t,a,n,o,c,s,r,l,d,u,p,m,h,j,_,b,O,w,y,T,I,N,P,C;return i.a.wrap((function _callee4$(i){for(;;)switch(i.prev=i.next){case 0:if(Object(S.a)({"datatype":"news_fts","behavior":"action","type":"fts_report","url":window.location.href}),e.formCheckHandle(),t=e.state,a=t.title,n=t.detail,o=t.isShowUserInfo,c=t.isShowPicInfo,s=t.isAllowTelVisit,r=t.uploadImgUrls,l=t.uploadVideoUrls,d=t.serverImgPath,u=t.serverVideoPath,p={"companyName":"","companyId":""},m="",h="",j="",_="",b=e.$instance&&e.$instance.router&&e.$instance.router.params||{},O=b.domainId,w=O?"updateComplainCompanyData":"complainCompanyData",(y=Object(x.getStorageSync)(w))&&y.length>0&&y.forEach((function(e){"objectWord"!==e.name||(p=e.data),"questionWords"===e.name&&(m=e.data),"requireWords"===e.name&&(h=e.data),"moneyNo"===e.name&&(j=e.data),"orderNo"===e.name&&(_=e.data)})),!e.errorTipSwitch){i.next=15;break}return Object(x.pageScrollTo)({"scrollTop":0,"selector":"body"}),i.abrupt("return",!1);case 15:return Object(x.showLoading)({"title":"提交投诉中","mask":!0}),T=d.concat(r),console.log(T),i.next=20,Object(v.e)(T,_);case 20:return T=i.sent,I=u.concat(l),N={"enterpriseId":p.companyId,"enterpriseName":p.companyName,"question":m,"requirement":h,"relatedMoney":j,"relatedOrder":_,"title":a,"content":n,"uploadImgUrls":T,"uploadVideoUrls":I,"isOpenResources":!c,"isAnonymous":o,"isSyncPhone":s,"domainId":O},P=O?"POST":"PUT",i.next=26,Object(f.g)(N,P);case 26:C=i.sent,Object(x.hideLoading)(),C&&200===C.code&&"success"===C.message?(e.setState({"title":"","detail":"","isShowUserInfo":!1,"isAllowTelVisit":!1,"isOpenFileUpload":!1}),O?(Object(x.removeStorageSync)("updateComplainCompanyData"),Object(x.removeStorageSync)("updateComplainDetailData")):(Object(x.removeStorageSync)("complainCompanyData"),Object(x.removeStorageSync)("complainDetailData"),Object(x.removeStorageSync)("updateComplainCompanyData"),Object(x.removeStorageSync)("updateComplainDetailData")),Object(g.l)("/pages/complain/finish/index")):C&&C.message?Object(x.showToast)({"title":C.message,"icon":"none","duration":2e3}):Object(x.showToast)({"title":"上传参数有误","icon":"none","duration":2e3});case 29:case"end":return i.stop()}}),_callee4)})))),Object(u.a)(Object(r.a)(e),"detailChangeHandle",(function(t){e.setState({"detail":t})})),Object(u.a)(Object(r.a)(e),"deleteServerImage",(function(t){var a=e.state,n=a.serverImgPath,i=a.secretImgPath;n.splice(t,1),i.splice(t,1),e.setState({"serverImgPath":n,"secretImgPath":i})})),Object(u.a)(Object(r.a)(e),"deleteServerVideo",(function(t){var a=e.state,n=a.serverVideoPath,i=a.secretVideoPath;n.splice(t,1),i.splice(t,1),e.setState({"serverVideoPath":n,"secretVideoPath":i})})),Object(u.a)(Object(r.a)(e),"getUploadHandle",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e.state.domainId;n?e.storageDataInit("updateComplainDetailData"):e.storageDataInit("complainDetailData"),e.setState({"uploadImgUrls":t,"uploadVideoUrls":a})})),e}return Object(s.a)(Details,[{"key":"componentDidShow","value":(t=Object(o.a)(i.a.mark((function _callee5(){var e,t;return i.a.wrap((function _callee5$(a){for(;;)switch(a.prev=a.next){case 0:if(e=this.$instance&&this.$instance.router&&this.$instance.router.path||"",t="",t=Object(w.b)()?Object(g.j)(e).domainId:this.$instance.router.params.domainId,this.setState({"isOpenFileUpload":!0,"domainId":t}),!t){a.next=9;break}return a.next=7,this.updateDateInit(t);case 7:a.next=10;break;case 9:this.storageDataInit("complainDetailData");case 10:this.getUserPhoneNumberHandle(),this.iphoneSpecialHandle();case 12:case"end":return a.stop()}}),_callee5,this)}))),function componentDidShow(){return t.apply(this,arguments)})},{"key":"render","value":function render(){var e=this,t=this.state,a=t.title,n=t.detail,i=t.isShowUserInfo,o=t.isAllowTelVisit,c=t.isShowPicInfo,s=t.secretImgPath,r=t.secretVideoPath,l=t.errorWaring,d=t.phoneNumber,u=t.isOpenFileUpload,p=t.isShowTitleClose;return Object(y.jsxs)(m.o,{"className":O.a.details,"children":[Object(y.jsx)(h.a,{"step":2}),Object(y.jsx)(m.o,{"className":O.a.detailsBox,"children":Object(y.jsxs)(m.o,{"className":O.a.formList,"children":[Object(y.jsxs)(m.o,{"className":O.a.titleBox,"children":[Object(y.jsxs)(m.o,{"className":O.a.moduleTh,"children":[Object(y.jsx)(m.l,{"className":"".concat(O.a.moduleText),"children":"投诉标题"}),Object(y.jsx)(m.l,{"className":O.a.moduleInfo,"children":"标题字数为4-40个字"})]}),Object(y.jsx)(m.o,{}),Object(y.jsxs)(m.o,{"onClick":function onClick(){Object(S.a)({"datatype":"news_fts","behavior":"action","type":"fts_tsbt","url":window.location.href})},"className":O.a.titleBd,"children":[Object(y.jsx)(m.f,{"className":O.a.titleInputText,"placeholder":"概括核心问题，最好包含商家","type":"text","value":a,"onInput":function onInput(t){e.inputChangeHandle(t,"title")}}),p&&Object(y.jsx)(m.o,{"className":O.a.titleClose,"onClick":this.clearStateHandle.bind(this,"title")})]}),l.title&&Object(y.jsx)(m.o,{"className":O.a.errorTip,"children":l.title})]}),Object(y.jsxs)(m.o,{"className":O.a.detail,"children":[Object(y.jsxs)(m.o,{"className":O.a.moduleTh,"children":[Object(y.jsx)(m.l,{"className":"".concat(O.a.moduleText),"children":"投诉详情"}),Object(y.jsx)(m.l,{"className":O.a.moduleInfo,"children":"详情字数至少20个字"})]}),Object(y.jsx)(_.a,{"theme":"white","defaultPlaceholder":"请输入投诉详情","defaultDetail":n,"detailChangeHandle":this.detailChangeHandle})]}),l.detail&&Object(y.jsx)(m.o,{"className":O.a.errorTip,"children":l.detail}),Object(y.jsxs)(m.o,{"className":O.a.attachment,"children":[Object(y.jsxs)(m.o,{"className":O.a.moduleTh,"children":[Object(y.jsx)(m.l,{"className":O.a.moduleText,"children":"上传附件"}),Object(y.jsx)(m.l,{"className":O.a.moduleInfo,"children":"添加相关截图会提高投诉成功率"})]}),u&&Object(y.jsxs)(m.o,{"className":O.a.attachmentBd,"children":[Object(y.jsx)(j.a,{"deleteServerImage":this.deleteServerImage,"deleteServerVideo":this.deleteServerVideo,"getUploadHandle":this.getUploadHandle,"secretImgPath":s,"secretVideoPath":r,"saveData":this.savePageData}),Object(y.jsx)(m.o,{"className":O.a.attachmentButtonText,"children":"上传证据记得保护好个人隐私"})]}),l.picNum&&Object(y.jsx)(m.o,{"className":O.a.errorTip,"children":l.picNum}),l.videoNum&&Object(y.jsx)(m.o,{"className":O.a.errorTip,"children":l.videoNum})]}),Object(y.jsxs)(m.o,{"className":O.a.privacy,"children":[Object(y.jsx)(m.o,{"className":O.a.privacyText,"children":"隐藏附件"}),Object(y.jsx)(m.k,{"color":c?"":"#d9d9d9","type":"switch","checked":c,"onChange":function onChange(t){e.inputChangeHandle(t,"isShowPicInfo")},"className":O.a.privacySwitch})]}),Object(y.jsxs)(m.o,{"className":O.a.privacy,"children":[Object(y.jsx)(m.o,{"className":O.a.privacyText,"children":"匿名"}),Object(y.jsx)(m.k,{"color":i?"":"#d9d9d9","type":"switch","checked":i,"onChange":function onChange(t){e.inputChangeHandle(t,"isShowUserInfo")},"className":O.a.privacySwitch})]}),Object(y.jsx)(m.o,{"className":O.a.privacyTip,"children":"开启后则投诉页不显示您的头像及昵称"}),Object(y.jsxs)(m.o,{"className":O.a.contact,"children":[Object(y.jsx)(m.o,{"className":O.a.privacyTex,"children":"商家将通过本平台预留的手机号码联系您"}),Object(y.jsxs)(m.o,{"className":O.a.privacyTel,"children":[Object(y.jsx)(m.o,{"className":O.a.privacyInfo,"children":"本人电话可同步媒体联系采访"}),Object(y.jsx)(m.k,{"color":o?"":"#d9d9d9","type":"checkbox","className":O.a.privacyCheckbox,"checked":o,"onChange":function onChange(t){e.inputChangeHandle(t,"isAllowTelVisit")}})]}),Object(y.jsx)(m.o,{"className":O.a.privacyTelNumber,"children":d})]})]})}),Object(y.jsxs)(m.o,{"className":O.a.operation,"children":[Object(y.jsx)(m.o,{"className":O.a.prevButton,"onClick":this.toBackPage,"children":"上一步"}),Object(y.jsx)(m.o,{"className":O.a.submitButton,"onClick":this.submitDataHandle,"children":"提交"})]})]})}}]),Details}(p.Component);t.default=T}}]);