(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{"159":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var o=n(4),r={"HOSTURL":"https://stadig.ifeng.com/appsta.js","DATATYPE":"newsappsns","USERAGENT":"object"===("undefined"==typeof navigator?"undefined":Object(o.a)(navigator))?navigator.userAgent.toLocaleLowerCase():"","FILTERKEY":["hosturl","datatype","behavior","environment"],"init":function init(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.getHostParams(e),n=this.getSessionParams(e),o="".concat(t,"&session=").concat(n);this.sendStatistics(o)},"sendStatistics":function sendStatistics(e){if("object"!==("undefined"==typeof document?"undefined":Object(o.a)(document)))return!1;var t=document.createElement("script");t.src=e,t.async="async",document.body.appendChild(t)},"getSessionParams":function getSessionParams(e){var t=this,n=[];if(Array.isArray(e)&&e[0])e.forEach((function(e){var o=[],r=e.behavior||"";for(var a in e)t.FILTERKEY.includes(a)||o.push("".concat(a,"=").concat(encodeURIComponent(e[a])));n.push("".concat(t.getTimeFormat(),"#").concat(r,"#").concat(o.join("$")))}));else{var o=e.behavior||"",r=[];for(var a in e)this.FILTERKEY.includes(a)||r.push("".concat(a,"=").concat(encodeURIComponent(e[a])));n.push("".concat(this.getTimeFormat(),"#").concat(o,"#").concat(r.join("$")))}return encodeURIComponent(n.join("@"))},"getHostParams":function getHostParams(e){var t=Array.isArray(e)&&e[0]?e[0]:e,n=t.hosturl||this.HOSTURL,o=t.datatype||this.DATATYPE;return"".concat(n,"?datatype=").concat(o,"&mos=").concat(this.getSystem(),"&userkey=").concat(this.getUserkey(),"&ua=").concat(encodeURIComponent(this.USERAGENT),"&share=").concat(this.getSourceName())},"setCookie":function setCookie(e,t,n,r,a,i){if("object"!==("undefined"==typeof document?"undefined":Object(o.a)(document)))return!1;var c="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t));n instanceof Date&&(c="".concat(c,";expires=").concat(n.toGMTString())),r&&(c="".concat(c,";path=").concat(r)),a&&(c="".concat(c,";domain").concat(a)),i&&(c="".concat(c,";secure")),document.cookie=c},"getCookie":function getCookie(e){if("object"!==("undefined"==typeof document?"undefined":Object(o.a)(document)))return"";var t="".concat(encodeURIComponent(e),"="),n=document.cookie.indexOf(t),r=null;if(n>-1){var a=document.cookie.indexOf(";",n);-1===a&&(a=document.cookie.length),r=document.cookie.substring(n+t.length,a),r=decodeURIComponent(r)}return r},"getSystem":function getSystem(){var e=this.USERAGENT;return e.match(/iphone|ipod/gi)||e.match(/ipad/gi)?"iphone":e.match(/android/gi)?"android":"windows"},"createUserkey":function createUserkey(e){for(var t=e||32,n="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",o=n.length,r="",a=0;a<t;a++)r+=n.charAt(Math.floor(Math.random()*o));return r},"getUserkey":function getUserkey(){if(this.getCookie("userkey"))return this.getCookie("userkey");var e=this.createUserkey(15),t=new Date;return t.setTime(t.getTime()+2592e6),this.setCookie("userkey",e,t,"/"),e},"getSourceName":function getSourceName(){var e=this.USERAGENT;return e.match(/wxwork/gi)?"qywx":e.match(/MicroMessenger/gi)?"wx":e.match(/QQ\//)?"qq":e.match(/WeiBo/i)?"weibo":"unknown"},"singleNumberAddZero":function singleNumberAddZero(e){return e>9?e:"0".concat(e)},"getTimeFormat":function getTimeFormat(){var e=new Date,t=e.getFullYear(),n=this.singleNumberAddZero(e.getMonth()+1),o=this.singleNumberAddZero(e.getDate()),r=this.singleNumberAddZero(e.getHours()),a=this.singleNumberAddZero(e.getMinutes()),i=this.singleNumberAddZero(e.getSeconds()),c="".concat(t,"-").concat(n,"-").concat(o,"+").concat(r,":").concat(a,":").concat(i);return e?c:""}},a={"FILTERKEY":["hosturl","datatype","behavior","environment"],"init":function init(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==("undefined"==typeof window?"undefined":Object(o.a)(window)))return!1;window.grounds=window.grounds?window.grounds:{},window.grounds.pageStat=window.grounds.pageStat?window.grounds.pageStat:this.newFunction,window.grounds.actionStat=window.grounds.actionStat?window.grounds.actionStat:this.newFunction,window.grounds.expose=window.grounds.expose?window.grounds.expose:this.newFunction,Array.isArray(t)?t.forEach((function(t){"page"===t.behavior&&window.grounds.pageStat(e.formateParams(t)),"action"===t.behavior&&window.grounds.actionStat(e.formateParams(t)),"pageinfo"===t.behavior&&window.grounds.expose(e.formateParams(t))})):("page"===t.behavior&&window.grounds.pageStat(this.formateParams(t)),"action"===t.behavior&&window.grounds.actionStat(this.formateParams(t)),"pageinfo"===t.behavior&&window.grounds.expose(this.formateParams(t)))},"formateParams":function formateParams(e){var t={};for(var n in e)this.FILTERKEY.includes(n)||(t[n]=encodeURIComponent(e[n]));return JSON.stringify(t)},"newFunction":function newFunction(e){console.log(e)}},i=function pageStatistics(e){if("object"!==("undefined"==typeof window?"undefined":Object(o.a)(window)))return!1;"client"===(e.environment||(window.grounds?"client":"h5"))?function clientStatistics(e){a.init(e)}(e):function h5Statistics(e){r.init(e)}(e)}},"195":function(e,t,n){"use strict";var o=n(5),r=n(2),a=n.n(r),i=n(13),c=n(10),s=n(8),u=n(9),d=n(20),l=n(17),p=n(18),f=n(11),h=n(230),g=n(26),m=n(22),v=n(3),b=n(140),y=n(139);t.a=function UploadH5(e){return function(t){Object(l.a)(T,t);var n=Object(p.a)(T);function T(){var e;Object(s.a)(this,T);for(var t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return e=n.call.apply(n,[this].concat(o)),Object(f.a)(Object(d.a)(e),"state",{"imgPath":[],"VideoPath":[],"uploadImgPathArray":[],"uploadVideoPathArray":[],"processArray":[]}),Object(f.a)(Object(d.a)(e),"events",new v.default.Events),Object(f.a)(Object(d.a)(e),"uploadCore",null),Object(f.a)(Object(d.a)(e),"convertObjectUrlToBlob",(function(e){return new Promise((function(t,n){var o=new XMLHttpRequest;o.open("GET",e,!0),o.responseType="blob",o.onload=function(){200===this.status?t(this.response):n({"status":this.status})},o.send()}))})),Object(f.a)(Object(d.a)(e),"choose",function(){var t=Object(c.a)(a.a.mark((function _callee(t,n,o,r){var c,s,u,d,l,p,f,h,g;return a.a.wrap((function _callee$(a){for(;;)switch(a.prev=a.next){case 0:if(!n){a.next=17;break}return a.prev=1,a.next=4,Object(v.chooseImage)({"count":o||9,"sourceType":Object(i.a)(t)});case 4:if(c=a.sent,s=c.tempFiles,u=c.tempFilePaths,d=void 0===u?[]:u,!r){a.next=9;break}if(!e.isHasMaxFile(s,r)){a.next=9;break}return a.abrupt("return",!1);case 9:e.uploadAll(n,s,d),a.next=15;break;case 12:a.prev=12,a.t0=a.catch(1),console.log(a.t0);case 15:a.next=33;break;case 17:return a.prev=17,a.next=20,Object(v.chooseVideo)({"sourceType":Object(i.a)(t),"compressed":!0});case 20:if(l=a.sent,p=l.tempFiles,f=l.tempFilePaths,!r){a.next=25;break}if(!e.isHasMaxFile(p,r)){a.next=25;break}return a.abrupt("return",!1);case 25:g=[],p.length&&(h=p.filter((function(e,t){return console.log(e,t),"image/png"!==e.type&&"image/jpeg"!==e.type&&(g.push(f[t]),!0)}))),h.length&&e.uploadAll(n,h,g),a.next=33;break;case 30:a.prev=30,a.t1=a.catch(17),console.log(a.t1);case 33:case"end":return a.stop()}}),_callee,null,[[1,12],[17,30]])})));return function(e,n,o,r){return t.apply(this,arguments)}}()),Object(f.a)(Object(d.a)(e),"isHasMaxFile",(function(t,n){if(!t)return!1;for(var o=0,r=t.length;o<r;o++){if((t[o]&&t[o].size||0)>(n||104857600))return e.events.trigger("hasMaxFile"),!0}return!1})),Object(f.a)(Object(d.a)(e),"uploadAll",function(){var t=Object(c.a)(a.a.mark((function _callee3(t,n,o){var r,i,s,u,d,l,p,f;return a.a.wrap((function _callee3$(h){for(;;)switch(h.prev=h.next){case 0:return h.prev=0,e.events.trigger("starUpload"),r=n.map(function(){var t=Object(c.a)(a.a.mark((function _callee2(t){var n;return a.a.wrap((function _callee2$(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,e.convertObjectUrlToBlob(t.path);case 2:return n=o.sent,o.abrupt("return",new Promise((function(o,r){try{t.size>10485760?e.uploadCore.uploadBigFile({"file":n,"success":function success(e){o(e.sourcePath)},"error":function error(e){console.error("上传出错啦",e),r(0)}}):e.uploadCore.uploadFile({"file":n,"success":function success(e){o(e.sourcePath)},"error":function error(e){console.error("上传出错啦",e),r(0)}})}catch(e){console.log(e),r(0)}})));case 4:case"end":return o.stop()}}),_callee2)})));return function(e){return t.apply(this,arguments)}}()),h.next=5,Object(g.a)(r);case 5:i=h.sent,s=[],u=[],i.forEach((function(e,t){e.value?s.push(o[t]):u.push(o[t])})),d=e.state.uploadImgPathArray,l=e.state.uploadVideoPathArray,p=e.state.imgPath,f=e.state.VideoPath,t?(d=d.concat(i.filter((function(e){return e.value})).map((function(e){return e.value}))),p=p.concat(s)):(l=l.concat(i.filter((function(e){return e.value})).map((function(e){return e.value}))),f=f.concat(s)),e.setState({"imgPath":p,"VideoPath":f,"uploadImgPathArray":d,"uploadVideoPathArray":l}),e.events.trigger("uploadFinish",d,l,u),e.events.trigger("endUpload"),h.next=22;break;case 19:h.prev=19,h.t0=h.catch(0),console.log(h.t0);case 22:case"end":return h.stop()}}),_callee3,null,[[0,19]])})));return function(e,n,o){return t.apply(this,arguments)}}()),Object(f.a)(Object(d.a)(e),"deleteImg",(function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1===n){var o=e.state.imgPath,r=e.state.uploadImgPathArray;o.splice(t,1),r.splice(t,1),e.setState({"imgPath":o,"uploadImgPathArray":r})}else{var a=e.state.VideoPath,i=e.state.uploadVideoPathArray;a.splice(t,1),i.splice(t,1),e.setState({"VideoPath":a,"uploadVideoPathArray":i})}})),e}return Object(u.a)(T,[{"key":"componentDidMount","value":function componentDidMount(){this.uploadCore=new h.Core({"appid":"ifeng-complaint","token":Object(v.getStorageSync)("Authorization"),"apiUrl":g.u,"initFail":function initFail(e){throw console.error("error",e),new Error(e)}})}},{"key":"render","value":function render(){var t=this.state,n=t.uploadImgPathArray,r=t.imgPath,a=t.VideoPath,i=t.processArray,c=t.uploadVideoPathArray;return Object(y.jsx)(b.o,{"children":Object(y.jsx)(e,Object(o.a)(Object(o.a)({"choose":this.choose,"imgPath":r,"VideoPath":a,"uploadImgPathArray":n,"deleteImg":this.deleteImg},this.props),{},{"processArray":i,"uploadVideoPathArray":c,"events":this.events}))})}}]),T}(m.Component)}},"230":function(e,t,n){"use strict";var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function fulfilled(e){try{step(o.next(e))}catch(e){a(e)}}function rejected(e){try{step(o.throw(e))}catch(e){a(e)}}function step(e){e.done?r(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((o=o.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,o,r,a,i={"label":0,"sent":function sent(){if(1&r[0])throw r[1];return r[1]},"trys":[],"ops":[]};return a={"next":verb(0),"throw":verb(1),"return":verb(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function verb(a){return function(c){return function step(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,o&&(r=2&a[0]?o.return:a[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,a[1])).done)return r;switch(o=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return i.label++,{"value":a[1],"done":!1};case 5:i.label++,o=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(r=i.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){i.label=a[1];break}if(6===a[0]&&i.label<r[1]){i.label=r[1],r=a;break}if(r&&i.label<r[2]){i.label=r[2],i.ops.push(a);break}r[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],o=0}finally{n=r=0}if(5&a[0])throw a[1];return{"value":a[0]?a[1]:void 0,"done":!0}}([a,c])}}};Object.defineProperty(t,"__esModule",{"value":!0}),t.generateGuid=t.generateKey=t.getFileSuffix=t.isVideo=t.isImage=t.Core=void 0;var a=n(187);function getFileSuffix(e){return e.split("/")[1]}function isImage(e){return/^image*/.test(e.type)}function isVideo(e){return/^video*/.test(e.type)}function generateKey(e){return o(this,void 0,void 0,(function(){var t,n;return r(this,(function(o){switch(o.label){case 0:return isImage(e)?(t=URL.createObjectURL(e),[4,(r=t,new Promise((function(e){var t=new Image;t.src=r,t.onload=function(){e({"width":t.width,"height":t.height})}})))]):[3,2];case 1:return n=o.sent(),URL.revokeObjectURL(t),n?[2,"img/"+generateGuid(e)+"_w"+n.width+"_h"+n.height+"."+getFileSuffix(e.type)]:[2,"img/"+generateGuid(e)+"."+getFileSuffix(e.type)];case 2:return isVideo(e)?[2,"video/"+generateGuid(e)+"."+getFileSuffix(e.type)]:[2,generateGuid(e)+"."+getFileSuffix(e.type)];case 3:return[2]}var r}))}))}function generateGuid(e){var t=new Date,n=URL.createObjectURL(e),o=n.substring(n.length-36);return URL.revokeObjectURL(n),t.toLocaleDateString()+"/"+o}t.getFileSuffix=getFileSuffix,t.isImage=isImage,t.isVideo=isVideo,t.generateKey=generateKey,t.generateGuid=generateGuid;var i=function(){function Core(e){this.appid=e.appid,this.token=e.token,this.Bucket=e.bucket||"ifeng-cos-ugc-upload-1300722751",this.Region=e.region||"ap-beijing",this.apiUrl=e.apiUrl||"https://skserver.ifeng.com/cos/getCredential",this.cos=null,this.initFail=e.initFail,this.init(),this.urlPrefix=""}return Core.prototype.init=function(){var e=this;this.cos=new a({"getAuthorization":function getAuthorization(t,n){try{var o=new FormData,r=new XMLHttpRequest;r.open("POST",e.apiUrl,!0),r.onreadystatechange=function(){if(4===r.readyState)if(r.status>=200&&r.status<300||304===r.status)try{var t=new Function("return "+r.responseText)();0===t.code?(e.urlPrefix=t.data.urlPrefix,n({"TmpSecretId":t.data.credentials.tmpSecretId,"TmpSecretKey":t.data.credentials.tmpSecretKey,"XCosSecurityToken":t.data.credentials.sessionToken,"StartTime":t.data.startTime,"ExpiredTime":t.data.expiredTime})):e.initFail&&e.initFail(t.msg)}catch(t){e.initFail&&e.initFail("获取签名失败，请刷新重试")}else e.initFail&&e.initFail("获取签名失败，请刷新重试")},o.append("appId",e.appid),o.append("token",e.token),r.send(o)}catch(t){e.initFail&&e.initFail("获取签名失败，请刷新重试")}}})},Core.prototype.uploadFile=function(e){var t=e.file,n=e.key,a=e.success,i=e.error,c=e.progress,s=e.options;return o(this,void 0,void 0,(function(){var e,o,u,d,l,p,f,h;return r(this,(function(r){switch(r.label){case 0:return(e=n)?[3,2]:[4,generateKey(t)];case 1:e=r.sent(),r.label=2;case 2:return n=e,o=this,d=(u=s||{}).needAutoOrient,l=void 0!==d&&d,p=u.Headers,f=void 0===p?{}:p,h=l?{"Pic-Operations":'{"rules": [{"fileid": "/'+n+'", "rule": "imageMogr2/auto-orient"}]}'}:{},this.cos.putObject({"Bucket":this.Bucket,"Region":this.Region,"Key":n,"Body":t,"Headers":Object.assign(h,f),"onProgress":function onProgress(e){c&&c(e)}},(function(e){e?i&&i(e):a&&a({"sourcePath":o.urlPrefix+"/"+n,"key":n})})),[2]}}))}))},Core.prototype.uploadBigFile=function(e){var t=e.file,n=e.key,a=e.success,i=e.error,c=e.progress,s=e.options;return o(this,void 0,void 0,(function(){var e,o,u,d,l,p,f,h;return r(this,(function(r){switch(r.label){case 0:return e=this,(o=n)?[3,2]:[4,generateKey(t)];case 1:o=r.sent(),r.label=2;case 2:return n=o,d=(u=s||{}).needAutoOrient,l=void 0!==d&&d,p=u.Headers,f=void 0===p?{}:p,h=l?{"Pic-Operations":'{"rules": [{"fileid": "/'+n+'", "rule": "imageMogr2/auto-orient"}]}'}:{},[2,new Promise((function(o){e.cos.sliceUploadFile({"Bucket":e.Bucket,"Region":e.Region,"Key":n,"Body":t,"Headers":Object.assign(h,f),"onTaskReady":function onTaskReady(t){o({"abort":function abort(){e.cos.cancelTask(t)},"restart":function restart(){e.cos.restartTask(t)},"pause":function pause(){e.cos.pauseTask(t)}})},"onProgress":function onProgress(e){c&&c(e)}},(function(t){t?i&&i(t):a&&a({"sourcePath":e.urlPrefix+"/"+n,"key":"/"+n})}))}))]}}))}))},Core}();t.Core=i}}]);